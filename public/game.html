<!--
    IMD3901B Design Studio 3 Winter 2022
    Term Project - The Sacred Meeting Place
    Triple Peanuts - Angelina Belingan, Jacqueline Lee, Violet Nguyen 
-->

<!DOCTYPE html>
<html>
<head>
    <title>The Sacred Meeting Place</title>
    <meta name="description" content="The Sacred Meeting Place, a WebVR storytelling experience.">
    <script src="/js/aframe.min.js"></script>
    <script src="/js/aframe-environment-component.min.js"></script>
    <script src="/js/wall-interaction-1.js"></script>
    <script src="/js/wall-interaction-2.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>

    <link rel="stylesheet" href="/css/user-gesture.css">

    <script>
        AFRAME.registerComponent('start-experience', {
            init: function () {
                console.log('scene loaded');
                document.querySelector('#user-gesture-button').style.display = 'block';
            }
        });

        const startExperience = function () {
            // Hide user-gesture overlay
            document.querySelector('#user-gesture-overlay').style.display = 'none';

            //start ambient music
            const ambientSounds = document.querySelectorAll('.bgm');
            ambientSounds.forEach(function (soundEntity) {
                soundEntity.components.sound.playSound();
            });
        }
    </script>
</head>

    <body>
        <div id="user-gesture-overlay">
            <div class="center">
                <!-- Brief introduction -->
                <p>
                    The Chaudiere Falls and Islands, the sacred and peaceful Indigenous meeting place since time immemorial.<br>
                    You recently disover an entrance to a cave that is located under the Chaudiere Falls.<br>
                    Make your way to the cave and undergo a storytelling experience of 400 years worth of Indigenous history.<br>
                    <br>
                    Controls<br>
                    - WASD keys for movement<br>
                    - Move mouse for camera movement<br>
                    - Left-click to interact<br>
                </p>

                <button onclick="startExperience();">Enter the Caves</button>
            </div>
        </div>

        <a-scene id="start-experience">
            <a-assets timeout="10000">
                <!-- Import models and other assets here -->
                <!-- Environment models -->
                <!--Trees-->
                <a-asset-item id="giantTree" src="assets/giant_low_poly_tree/scene.gltf"></a-asset-item>
                <a-asset-item id="singleTree" src="assets/tree_low-poly/scene.gltf"></a-asset-item>
                <a-asset-item id="lowTree" src="assets/low_poly_tree/scene.gltf"></a-asset-item>
                <!--Waterfall-->
                <a-asset-item id="blockyRock" src="assets/blocky_rocks/scene.gltf"></a-asset-item>
                <a-asset-item id="blockyRock2" src="assets/blocky_rocks/scene.gltf"></a-asset-item>
                <a-asset-item id="blockyRock3" src="assets/blocky_rocks/scene.gltf"></a-asset-item>
                <a-asset-item id="blockyRock4" src="assets/blocky_rocks/scene.gltf"></a-asset-item>
                <a-asset-item id="blockyRock5" src="assets/blocky_rocks/scene.gltf"></a-asset-item>
                <!--Cave Entrance-->
                <a-asset-item id="rockEntrance" src="assets/low-poly_rock/scene.gltf"></a-asset-item>
                <a-asset-item id="rockEntrance2" src="assets/low-poly_rock/scene.gltf"></a-asset-item>
                <a-asset-item id="rockEntrance3" src="assets/low-poly_rock/scene.gltf"></a-asset-item>
                <a-asset-item id="rockEntrance4" src="assets/low-poly_rock/scene.gltf"></a-asset-item>
                <!--Water-->
                
                <!--

            src="assets/low_poly_rocks_pack/scene.gltf"
            src="assets/low_poly_tree/scene.gltf"
            src="assets/low_poly_tree_pack/scene.gltf"
            src="assets/low_poly_rocks_set/scene.gltf"
            src="assets/rocks_low_poly_starter_pack/scene.gltf"
        -->
            </a-assets>

            <!--trees-->
            <a-entity position="-50 0 -5" scale="0.25 0.25 0.25" gltf-model="#giantTree"></a-entity>
            <a-entity position="-5 0 30" scale="0.01 0.01 0.01" gltf-model="#singleTree"></a-entity>
            <a-entity position="50 -1 -20" scale="1 1 1" gltf-model="#lowTree"></a-entity>
            <!--Waterfall-->
            <a-entity position="0 0 -90" scale="0.08 0.10 0.08" rotation="0 140 0" gltf-model="#blockyRock"></a-entity>
            <a-entity position="-70 0 -60" scale="0.08 0.04 0.08" rotation="0 180 0" gltf-model="#blockyRock2"></a-entity>
            <a-entity position="75 0 -60" scale="0.08 0.06 0.08" rotation="0 -100 0" gltf-model="#blockyRock3"></a-entity>
            <a-entity position="-100 0 -10" scale="0.10 0.05 0.08" rotation="0 140 0" gltf-model="#blockyRock4"></a-entity>
            <a-entity position="100 0 -5" scale="0.10 0.03 0.08" rotation="0 -180 0" gltf-model="#blockyRock5"></a-entity>
            <!--Cave entrance-->
            <a-entity position="0 0 -80" scale="1.5 3 1" gltf-model="#rockEntrance"></a-entity>
            <a-entity position="0 10 -80" scale="1 3 1" rotation="60 90 40" gltf-model="#rockEntrance2"></a-entity>
            <a-entity position="13 11 -70" scale="1 3 1" rotation="60 -90 40" gltf-model="#rockEntrance3"></a-entity>
            <a-entity position="13 0 -70" scale="1.5 3 1" rotation="0 200 0" gltf-model="#rockEntrance4"></a-entity>
            <!--Water to be added-->
            
            <!--Lead to cave 1-->
            <a-circle link="href: cave_01.html" id="caveEntrance" position="7 5 -75" radius="8.5" rotation="0 -40 0;" material="color:black;"></a-circle>
            <a-entity text="value: Click to enter cave;" position="8 5 -74" material="color:white;" rotation="0 -40 0" scale="5 5 5"></a-entity>


            <a-entity camera wasd-controls look-controls position="0 1.6 0">
                <a-entity cursor="rayOrigin:mouse;" raycaster="far:20; interval:200; object:.interactive"></a-entity>
                <a-entity light="type:spot; intensity:0.6; castShadow:true; shadowBias:-0.0005; angle:40; penumbra:1.0;" position="0.5 -0.5 0" rotation="0 0 0"></a-entity>
            </a-entity>

            <!-- Move to correct cave
            <a-entity>
                <a-entity class="left_wall"></a-entity>
                <a-entity id="wall_plane" position="-1 2 -3"
                          geometry="primitive:plane; width:10.0; height:10.0; depth:10.0;"
                          rotation="0 90 0;"
                          material="color:grey;"></a-entity>
            </a-entity>

            <a-entity>
                <a-entity class="right_wall"></a-entity>
                <a-entity id="wall_plane" position="5 2 -3"
                          geometry="primitive:plane; width:10.0; height:10.0; depth:10.0;"
                          rotation="0 -90 0;"
                          material="color:grey;"></a-entity>
            </a-entity>

            <a-entity>
                <a-entity class="wall interactive 1"></a-entity>
                <a-entity id="wall_art1" wall-interaction-1 position="-0.9 2 -3"
                          geometry="primitive:plane; width:1.0; height:1.0; depth:1.0;"
                          rotation="0 90 0;"
                          material="color:black;"></a-entity>
            </a-entity>

            <a-entity>
                <a-entity class="wall interactive 2"></a-entity>
                <a-entity id="wall_art2" wall-interaction-2 position="4.9 2 -3"
                          geometry="primitive:plane; width:1.0; height:1.0; depth:1.0;"
                          rotation="0 -90 0;"
                          material="color:black;"></a-entity>
            </a-entity>
             -->
            
            <!-- Art piece leads to cave 2 
            <a-entity>
                <a-entity class="wall interactive 3"></a-entity>
                <a-entity link="href: cave_02.html" ; id="wall_art3" position="4.9 2 -1"
                          geometry="primitive:plane; width:1.0; height:1.0; depth:1.0;"
                          rotation="0 -90 0;"
                          material="color:black;"></a-entity>
            </a-entity>
            -->

            <!-- Buttons to lead to art caves -->
            <a-entity id="universal_button">
                <a-entity class="button interactive" link="href: cave_03.html" ; position="8 0.6 -75" geometry="primitive:cylinder; radius:0.15; height:0.2;" material="color:rgb(255, 100, 100)"
                          animation__mouseenter="property:material.color; type:color; to:rgb(255, 0, 0); startEvents:mouseenter; dur:200"
                          animation__mouseleave="property:material.color; type:color; to:rgb(255, 100, 100); startEvents:mouseleave; dur:200"
                          animation__click="property:position.y; from:0.55; to:0.6; startEvents:click; dur:300" shadow></a-entity>
                <a-entity position="8 0.3 -75" geometry="primitive:box; width:0.5; depth:0.5; height:0.6;" material="color:rgb(255, 255, 255)" shadow></a-entity>
            </a-entity>
            
            <a-entity environment="preset:forest; ground:flat; groundTexture:walkernoise; dressing:stones; dressingColor:#575757; dressingOnPlayArea:0.050; dressingUniformScale:false; dressingScale:0"></a-entity>
        </a-scene>
    </body>
</html>